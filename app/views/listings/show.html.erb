<div class="container mt-3">
  <%= link_to "Back to all listings", listings_path %>
  <%# title %>
  <h1><%= @listing.title %></h1>
  <%# available / sold %>
  <% if @listing.sold %>
    <div><p><i class="fas fa-circle text-danger"></i> SOLD </p></div>
  <% else %>
    <div><p><i class="fas fa-circle text-success"></i> AVAILABLE</i></div>
  <% end %>
  <% if @listing.user != current_user %>
    <%= link_to "Send a message to #{@listing.user.first_name}", conversation_path(@conversation) %>
  <% end %>

  <%# buttons %>
  <% if @listing.user == current_user %>
    <button type="button" class="btn btn-lg btn-light mb-4"> <%= link_to "Edit", edit_listing_path(@listing) %></button>
  <% else %>
    <div class="booking-offer-buttons d-flex mb-2">
      <% if @listing.sold %>
        <button type="button" class="btn btn-secondary btn-lg mr-4" disabled><%= link_to "Place an offer", new_listing_offer_path(@listing) %></button>
        <button type="button" class="btn btn-secondary btn-lg" disabled><%= link_to "Schedule a viewing", new_listing_booking_path(@listing) %></button>
      <% else %>
        <button type="button" class="btn btn-lg btn-light mr-4"><%= link_to "Place an offer", new_listing_offer_path(@listing) %></button>
        <button type="button" class="btn btn-lg btn-light"><%= link_to "Schedule a viewing", new_listing_booking_path(@listing) %></button>
      <% end %>
    </div>
  <% end %>
  <br>

  <%# photo %>
  <% if !@listing.photos.attached? %>
    <div></div>
  <% else %>
    <div class="listing-photo" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= cl_image_path @listing.photos.first.key, height: 300, width: 600, crop: :fill %>')">
    </div>
    <% @listing.photos.each do |photo| %>
      <%= cl_image_tag photo.key, height: 300, width: 400, crop: :fill %>
    <% end %>
  <% end %>

  <%# prices %>
  <h3><i class="fas fa-map-marker-alt mt-4"></i> <%= @listing.address %></h3>
  <h2><strong><i class="fas fa-pound-sign"></i> <%= @listing.price %></strong></h2>
  <p>Estimated Down Payment: <i class="fas fa-pound-sign"></i><%= (@listing.price * 0.1).to_f.round(6) %>
  <% if @listing.negotiable == false %>
    <p><strong> Non-negotiable </strong> </p>
  <% else %>
    <p><strong> Negotiable </strong> </p>
  <% end %>

  <%# size %>
  <% if @listing.size.nil? %>
    <p>No information on size available</p>
  <% else %>
    <p> <%= @listing.size %> sqm </p>
  <% end %>

  <%# bedroom / bathroom %>
  <div class="bedroom-bathroom d-flex">
    <i class="fas fa-bed"></i>
      <% if @listing.bedroom.nil? %>
        <p class="mr-3"> N/A</p>
      <% else %>
        <p class="mr-3"><%= @listing.bedroom %> Bedroom(s)</p>
      <% end %>
    <i class="fas fa-shower"></i>
      <% if @listing.bathroom.nil? %>
        <p> N/A</p>
      <% else %>
        <p><%= @listing.bathroom %> Bathroom(s)</p>
      <% end %>
  </div>


  <%# description %>
  <p><%= @listing.description %> Lorem ipsum dolor sit amet consectetur adipisicing elit. Unde, quod officiis quia maiores architecto sapiente, nostrum pariatur commodi minima, voluptate amet enim sunt similique incidunt velit exercitationem? Dolore, et doloribus.</p>

  <%# map %>
  <div id="map"
     style="width: 100%; height: 600px;"
     data-markers="<%= @markers.to_json %>"
     data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">

  </div>





  <hr>
</div>
